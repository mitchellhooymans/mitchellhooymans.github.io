<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projectile Motion Simulation | Mitchell Hooymans</title>
    <meta name="description"
        content="Interactive projectile motion simulation. Explore kinematics, adjusting speed, angle, and gravity in real-time.">
    <link rel="canonical" href="https://mitchellhooymans.com/simulations/projectile.html" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://mitchellhooymans.com/simulations/projectile.html">
    <meta property="og:title" content="Projectile Motion Simulation | Mitchell Hooymans">
    <meta property="og:description"
        content="Interactive projectile motion simulation. Explore kinematics, adjusting speed, angle, and gravity in real-time.">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="../styles.css">
    <link rel="shortcut icon" href="../images/favicon/favicon.ico" type="image/x-icon">
    <link rel="icon" type="image/png" sizes="32x32" href="../images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../images/favicon/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../images/favicon/apple-touch-icon.png">
    <link rel="manifest" href="../images/favicon/site.webmanifest">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <style>
        .content-section {
            max-width: 1000px;
            margin: 0 auto;
        }

        .simulation-wrapper {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--space-6);
        }

        @media (min-width: 900px) {
            .simulation-wrapper {
                grid-template-columns: 1fr 300px;
            }
        }

        .simulation-container {
            background: #000;
            border-radius: var(--radius-xl);
            overflow: hidden;
            box-shadow: var(--shadow-xl);
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            width: 100%;
        }

        #simulationCanvas {
            display: block;
            width: 100%;
            height: 100%;
            aspect-ratio: 16/9;
            background: linear-gradient(to bottom, #87CEEB 0%, #E0F7FA 100%);
            /* Sky blue gradient */
        }

        .sim-overlay {
            position: absolute;
            top: var(--space-3);
            left: var(--space-3);
            background: rgba(0, 0, 0, 0.7);
            border-radius: var(--radius-md);
            padding: var(--space-3);
            color: #fff;
            font-size: 0.75rem;
            font-family: 'Courier New', monospace;
            pointer-events: none;
        }

        .sim-overlay div {
            margin-bottom: var(--space-1);
        }

        .controls-panel {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-xl);
            padding: var(--space-5);
        }

        .controls-panel h3 {
            font-size: 1.1rem;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            padding-bottom: var(--space-2);
            margin-bottom: var(--space-4);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--color-white);
        }

        .control-section {
            margin-bottom: var(--space-5);
        }

        .control-section h4 {
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--color-gray-400);
            margin-bottom: var(--space-3);
        }

        .control-group {
            margin-bottom: var(--space-3);
        }

        .control-group label {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: var(--space-1);
            color: var(--color-white);
        }

        .control-value {
            font-family: 'Courier New', monospace;
            color: var(--color-accent);
            font-weight: 600;
        }

        input[type="range"] {
            width: 100%;
            height: 6px;
            background: var(--color-gray-300);
            border-radius: 3px;
            appearance: none;
            outline: none;
            transition: background 0.2s;
        }

        input[type="range"]:hover {
            background: var(--color-gray-400);
        }

        input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 18px;
            height: 18px;
            background: var(--color-accent);
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid #fff;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
            transition: transform 0.1s;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.1);
        }

        input[type="number"] {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            padding: 4px 8px;
            font-family: 'Courier New', monospace;
            color: var(--color-white);
            font-weight: 600;
            width: 100%;
            outline: none;
            transition: all 0.2s;
        }

        input[type="number"]:focus {
            border-color: var(--color-accent);
            background: #fff;
            box-shadow: 0 0 0 2px rgba(var(--color-accent-rgb), 0.1);
            /* Assuming accent-rgb exists or ignore shadow if not */
        }

        /* Checkbox styling */
        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            font-weight: 500;
            color: var(--color-white);
            font-size: 0.9rem;
        }

        input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin: 0;
            cursor: pointer;
            accent-color: var(--color-accent);
        }

        /* Checkbox styling */
        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            font-weight: 500;
            color: var(--color-gray-700);
            font-size: 0.9rem;
        }

        .btn-row {
            display: flex;
            gap: var(--space-2);
            margin-top: var(--space-4);
        }

        .sim-btn {
            flex: 1;
            padding: var(--space-2);
            border-radius: var(--radius-md);
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            border: none;
        }

        .sim-btn-primary {
            background: var(--color-accent);
            color: white;
        }

        .sim-btn-primary:hover {
            background: var(--color-accent-hover);
        }

        .sim-btn-secondary {
            background: rgba(255, 255, 255, 0.05);
            color: var(--color-white);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sim-btn-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--color-white);
        }

        .presets-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }

        .preset-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--color-white);
            padding: 6px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
            text-align: center;
        }

        .preset-btn:hover,
        .preset-btn.active {
            border-color: var(--color-accent);
            background: var(--color-accent);
            color: white;
        }

        .info-card {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-left: 4px solid var(--color-accent);
            border-radius: var(--radius-lg);
            padding: var(--space-4);
            margin-bottom: var(--space-6);
        }

        .info-card h3 {
            margin-bottom: var(--space-2);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--color-white);
        }

        .info-card p {
            font-size: 0.95rem;
            color: var(--color-gray-300);
            line-height: 1.6;
            margin-bottom: 0.5rem;
        }

        /* Full Browser Mode */
        body.full-browser {
            overflow: hidden;
            height: 100vh;
            width: 100vw;
        }

        body.full-browser .nav,
        body.full-browser .page-header,
        body.full-browser .footer,
        body.full-browser .back-link,
        body.full-browser .info-card {
            display: none !important;
        }

        body.full-browser .section {
            padding: 0 !important;
            margin: 0 !important;
        }

        body.full-browser .container {
            max-width: none !important;
            width: 100vw !important;
            height: 100vh !important;
            padding: 0 !important;
        }

        body.full-browser .content-section {
            max-width: none !important;
            margin: 0 !important;
            height: 100% !important;
        }

        body.full-browser .simulation-wrapper {
            grid-template-columns: 1fr !important;
            height: 100% !important;
            gap: 0 !important;
        }

        body.full-browser .simulation-container {
            border-radius: 0 !important;
            height: 100% !important;
        }

        body.full-browser #simulationCanvas {
            aspect-ratio: auto !important;
            height: 100% !important;
        }

        body.full-browser .controls-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 320px;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            z-index: 1000;
            box-shadow: var(--shadow-2xl);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        body.full-browser .sim-overlay {
            top: 20px;
            left: 20px;
        }
    </style>
</head>

<body>
    <!-- Nav -->
    <!-- Navigation -->
    <div id="navbar-placeholder"></div>
    <script src="../js/navbar.js"></script>

    <!-- Mobile Menu -->

    <!-- Page Header -->
    <header class="page-header">
        <div class="container">
            <a href="../pages/simulations.html" class="back-link">
                <i class="fas fa-arrow-left"></i> Back to Simulations
            </a>
            <h1>Projectile Motion</h1>
            <p>Kinematics in action</p>
        </div>
    </header>

    <section class="section">
        <div class="container">


            <div class="content-section">
                <!-- Info Card -->
                <div class="info-card">
                    <h3><i class="fas fa-info-circle"></i> Understanding Projectile Motion</h3>
                    <p>
                        Projectile motion is the motion of an object thrown or projected into the air, subject to only
                        the acceleration of gravity.
                        The object is called a projectile, and its path is called its trajectory.
                    </p>
                </div>

                <div class="simulation-wrapper">
                    <!-- Canvas -->
                    <div class="simulation-container">
                        <canvas id="simulationCanvas"></canvas>

                        <div class="sim-overlay">
                            <div>Time: <span id="timeDisplay">0.00</span> s</div>
                            <div>Distance: <span id="distDisplay">0.00</span> m</div>
                            <div>Max Height: <span id="heightDisplay">0.00</span> m</div>
                        </div>
                    </div>

                    <!-- Controls -->
                    <div class="controls-panel">
                        <h3><i class="fas fa-sliders-h"></i> Configuration</h3>

                        <div class="btn-row" style="margin-bottom: var(--space-5); margin-top: 0;">
                            <button class="sim-btn sim-btn-primary" id="fireBtn">
                                <i class="fas fa-bullseye"></i> Fire!
                            </button>
                            <button class="sim-btn sim-btn-secondary" id="resetBtn">
                                <i class="fas fa-redo"></i> Clear
                            </button>
                        </div>

                        <button class="sim-btn sim-btn-secondary" id="fullBrowserBtn"
                            style="width: 100%; margin-bottom: var(--space-5);">
                            <i class="fas fa-expand"></i> Full Browser
                        </button>



                        <!-- Parameters -->
                        <div class="control-section">
                            <h4>Launch Parameters</h4>
                            <div class="control-group">
                                <label>Speed <span id="v0Value" class="control-value">50.0 m/s</span></label>
                                <input type="range" id="v0Slider" min="10" max="200" step="1" value="50">
                            </div>
                            <div class="control-group">
                                <label>Angle <span id="angleValue" class="control-value">45°</span></label>
                                <input type="range" id="angleSlider" min="0" max="90" step="1" value="45">
                            </div>
                            <div class="control-group">
                                <label>Mass <span id="massValue" class="control-value">10.0 kg</span></label>
                                <input type="range" id="massSlider" min="0.1" max="100" step="0.1" value="10.0">
                            </div>
                            <div class="control-group">
                                <label>Initial Height <span id="h0Value" class="control-value">0.0 m</span></label>
                                <input type="range" id="h0Slider" min="0" max="100" step="1" value="0">
                            </div>
                        </div>

                        <!-- Environment -->
                        <div class="control-section">
                            <h4>Environment</h4>

                            <!-- Gravity -->
                            <div class="control-group">
                                <label>Gravity (m/s²)</label>
                                <input type="number" id="gInput" step="0.01" value="9.81">
                            </div>
                            <div class="presets-grid" style="margin-bottom: var(--space-4);">
                                <button class="preset-btn active" data-type="gravity" data-value="9.81">Earth</button>
                                <button class="preset-btn" data-type="gravity" data-value="1.62">Moon</button>
                                <button class="preset-btn" data-type="gravity" data-value="24.79">Jupiter</button>
                                <button class="preset-btn" data-type="gravity" data-value="3.71">Mars</button>
                            </div>

                            <!-- Air Resistance -->
                            <div class="control-group">
                                <label>Drag Coeff. (Cd)</label>
                                <input type="number" id="cdInput" step="0.01" value="0.0">
                            </div>
                            <div class="presets-grid">
                                <button class="preset-btn active" data-type="drag" data-value="0">Vacuum</button>
                                <button class="preset-btn" data-type="drag" data-value="0.04">Streamlined</button>
                                <button class="preset-btn" data-type="drag" data-value="0.47">Sphere</button>
                                <button class="preset-btn" data-type="drag" data-value="1.05">Cube</button>
                            </div>
                        </div>

                        <!-- Visualization -->
                        <div class="control-section">
                            <h4>Visualization</h4>
                            <div class="control-group">
                                <label>Zoom <span id="zoomValue" class="control-value">2.0 px/m</span></label>
                                <input type="range" id="zoomSlider" min="0.5" max="10" step="0.5" value="2.0">
                            </div>
                            <div class="control-group">
                                <label>Speed <span id="speedValue" class="control-value">1.0x</span></label>
                                <input type="range" id="speedSlider" min="0.1" max="5.0" step="0.1" value="1.0">
                            </div>
                            <div class="control-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="nightModeToggle">
                                    <span>Night Mode</span>
                                </label>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div>
                    <div class="footer-brand">Mitchell Hooymans</div>
                    <p class="footer-tagline">Astrophysicist & STEM Communicator</p>
                </div>
                <!-- ... Social Links ... -->
                <div class="social-links">
                    <a href="https://www.linkedin.com/in/mitchell-hooymans/" class="social-link" aria-label="LinkedIn"
                        target="_blank">
                        <i class="fab fa-linkedin-in"></i>
                    </a>
                    <a href="https://github.com/mitchellhooymans" class="social-link" aria-label="GitHub"
                        target="_blank">
                        <i class="fab fa-github"></i>
                    </a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 Mitchell Hooymans. All Rights Reserved.</p>
            </div>
        </div>
    </footer>

    <script>

        // ========================================
        // Simulation Setup
        // ========================================
        const canvas = document.getElementById('simulationCanvas');
        const ctx = canvas.getContext('2d');

        function setupCanvas() {
            const rect = canvas.getBoundingClientRect();
            const dpr = window.devicePixelRatio || 1;
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            ctx.resetTransform();
            ctx.scale(dpr, dpr);
        }
        setupCanvas();
        window.addEventListener('resize', setupCanvas);

        // Pan Event Listeners
        canvas.addEventListener('mousedown', (e) => {
            isDragging = true;
            lastMouseX = e.clientX;
            lastMouseY = e.clientY;
            canvas.style.cursor = 'grabbing';
        });

        window.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            const dx = e.clientX - lastMouseX;
            const dy = e.clientY - lastMouseY;
            panX += dx;
            panY += dy;
            lastMouseX = e.clientX;
            lastMouseY = e.clientY;
            render();
        });

        window.addEventListener('mouseup', () => {
            isDragging = false;
            canvas.style.cursor = 'grab';
        });

        canvas.addEventListener('dblclick', () => {
            panX = 0;
            panY = 0;
            render();
        });

        // Initialize cursor
        canvas.style.cursor = 'grab';

        // ========================================
        // State
        // ========================================
        let projectiles = [];
        let isSimulating = false;
        let animationId;
        let isNightMode = false;

        // View State (Panning)
        let panX = 0;
        let panY = 0;
        let isDragging = false;
        let lastMouseX = 0;
        let lastMouseY = 0;

        // Parameters
        let v0 = 50;
        let angleDeg = 45;
        let h0 = 0;
        let g = 9.81;
        let mass = 10.0;
        let cd = 0.0;
        let ppm = 2.0;
        let simSpeed = 1.0;

        // Constants for air properties
        const RHO = 1.225; // Air density (kg/m^3)
        const AREA = 0.01; // Cross-sectional area (m^2) ~11cm diameter ball

        class Projectile {
            constructor(v0, angleDeg, h0, g, mass, cd) {
                this.t = 0;
                this.mass = mass;
                this.cd = cd;
                this.g = g;

                this.angle = angleDeg * Math.PI / 180;

                // State vector
                this.x = 0;
                this.y = h0;
                this.maxHeight = h0;
                this.vx = v0 * Math.cos(this.angle);
                this.vy = v0 * Math.sin(this.angle);

                this.landed = false;
                this.path = [{ x: 0, y: h0 }];

                this.color = `hsl(${Math.random() * 360}, 70%, 50%)`;
            }

            update(dt) {
                if (this.landed) return;

                this.t += dt;

                // Forces
                // Gravity
                let fx = 0;
                let fy = -this.mass * this.g;

                // Drag: Fd = -0.5 * rho * A * cd * v^2 * (v_hat)
                if (this.cd > 0) {
                    const vSq = this.vx * this.vx + this.vy * this.vy;
                    const v = Math.sqrt(vSq);
                    if (v > 0.001) {
                        const dragMag = 0.5 * RHO * AREA * this.cd * vSq;
                        fx -= dragMag * (this.vx / v);
                        fy -= dragMag * (this.vy / v);
                    }
                }

                // Integration (Euler for simplicity, small dt makes it okay)
                // Symplectic Euler (velocity update then position)
                const ax = fx / this.mass;
                const ay = fy / this.mass;

                this.vx += ax * dt;
                this.vy += ay * dt;

                this.x += this.vx * dt;
                this.y += this.vy * dt;

                if (this.y > this.maxHeight) {
                    this.maxHeight = this.y;
                }

                // Ground collision
                if (this.y < 0) {
                    this.y = 0;
                    this.landed = true;
                    // Refine x position could go here but skipping for simplicity with drag
                }

                if (this.path.length < 1000 || this.t % 0.1 < dt) { // Optimize path points
                    this.path.push({ x: this.x, y: this.y });
                }
            }
        }

        // ========================================
        // Rendering
        // ========================================
        function drawGround() {
            const W = canvas.width / (window.devicePixelRatio || 1);
            const H = canvas.height / (window.devicePixelRatio || 1);

            // Background
            if (isNightMode) {
                // Night Sky
                const gradient = ctx.createLinearGradient(0, 0, 0, H);
                gradient.addColorStop(0, "#0f172a"); // Dark blue
                gradient.addColorStop(1, "#1e293b"); // Slate
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, W, H);

                // Stars
                ctx.fillStyle = "rgba(255, 255, 255, 0.5)";
                for (let i = 0; i < 30; i++) {
                    const x = (i * 123) % W;
                    const y = (i * 456) % (H * 0.7);
                    ctx.fillRect(x, y, 1, 1);
                }

                // Full Moon
                ctx.fillStyle = "#F4F6F0";
                ctx.shadowColor = "#FFFFE0";
                ctx.shadowBlur = 20;
                ctx.beginPath();
                ctx.arc(W - 80, 80, 40, 0, Math.PI * 2);
                ctx.fill();
                ctx.shadowBlur = 0; // Reset shadow
            } else {
                // Day Sky
                const gradient = ctx.createLinearGradient(0, 0, 0, H);
                gradient.addColorStop(0, "#87CEEB"); // Sky Blue
                gradient.addColorStop(1, "#E0F7FA"); // Light Blue
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, W, H);
            }

            // Ground is at bottom 50px
            const groundY = H - 50 + panY;

            // Ground fill
            ctx.fillStyle = isNightMode ? '#14532d' : '#4CAF50';
            ctx.fillRect(0, groundY, W, H - groundY + Math.abs(panY) + 100); // Pad height for panning

            // Ground line
            ctx.strokeStyle = isNightMode ? '#052e16' : '#2E7D32';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(0, groundY);
            ctx.lineTo(W, groundY);
            ctx.stroke();

            // Cannon platform
            const originX = 50 + panX;
            ctx.fillStyle = '#616161';
            ctx.fillRect(originX - 10, groundY - h0 * ppm, 20, h0 * ppm + 2);

            return { originX, groundY };
        }

        function drawCannon(originX, groundY) {
            ctx.save();
            ctx.translate(originX, groundY - h0 * ppm);
            ctx.rotate(-(angleDeg * Math.PI / 180));

            // Cannon barrel
            ctx.fillStyle = '#333';
            ctx.beginPath();
            ctx.rect(0, -5, 30, 10);
            ctx.fill();

            ctx.restore();

            // Pivot point
            ctx.fillStyle = '#000';
            ctx.beginPath();
            ctx.arc(originX, groundY - h0 * ppm, 5, 0, Math.PI * 2);
            ctx.fill();
        }

        function render() {
            const W = canvas.width / (window.devicePixelRatio || 1);
            const H = canvas.height / (window.devicePixelRatio || 1);

            ctx.clearRect(0, 0, W, H);

            const { originX, groundY } = drawGround();
            drawCannon(originX, groundY);

            projectiles.forEach(p => {
                // Draw path
                ctx.beginPath();
                ctx.strokeStyle = p.color;
                ctx.lineWidth = 2;
                if (p.path.length > 0) {
                    const start = p.path[0];
                    ctx.moveTo(originX + start.x * ppm, groundY - start.y * ppm);
                    for (let i = 1; i < p.path.length; i++) {
                        const pt = p.path[i];
                        ctx.lineTo(originX + pt.x * ppm, groundY - pt.y * ppm);
                    }
                }
                ctx.stroke();

                // Draw projectile
                const px = originX + p.x * ppm;
                const py = groundY - p.y * ppm;

                ctx.beginPath();
                ctx.fillStyle = p.color;
                ctx.arc(px, py, 6, 0, Math.PI * 2);
                ctx.fill();
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 1;
                ctx.stroke();
            });

            // Update stats for latest projectile
            if (projectiles.length > 0) {
                const latest = projectiles[projectiles.length - 1];
                document.getElementById('timeDisplay').textContent = latest.t.toFixed(2);
                document.getElementById('distDisplay').textContent = latest.x.toFixed(2);

                // Max height
                document.getElementById('heightDisplay').textContent = latest.maxHeight.toFixed(2);
            }
        }

        function loop(timestamp) {
            // Update physics
            if (isSimulating) {
                let allLanded = true;
                const dt = (1 / 60) * simSpeed; // Timestep scaled by speed

                projectiles.forEach(p => {
                    if (!p.landed) {
                        p.update(dt);
                        allLanded = false;
                    }
                });

                if (allLanded) isSimulating = false;
            }

            render();
            animationId = requestAnimationFrame(loop);
        }

        // Start loop
        loop();

        // ========================================
        // Controls
        // ========================================
        // ========================================
        // Controls
        // ========================================
        function updateUI() {
            document.getElementById('v0Value').textContent = parseFloat(v0).toFixed(1) + ' m/s';
            document.getElementById('angleValue').textContent = angleDeg + '°';
            document.getElementById('h0Value').textContent = h0 + ' m';
            document.getElementById('massValue').textContent = parseFloat(mass).toFixed(1) + ' kg';
            document.getElementById('zoomValue').textContent = parseFloat(ppm).toFixed(1) + ' px/m';
            document.getElementById('speedValue').textContent = parseFloat(simSpeed).toFixed(1) + 'x';

            // Sync number inputs (for presets)
            document.getElementById('gInput').value = parseFloat(g).toFixed(2);
            document.getElementById('cdInput').value = parseFloat(cd).toFixed(2);

            // Checkboxes
            document.getElementById('nightModeToggle').checked = isNightMode;

            // Highlight active presets
            document.querySelectorAll('.preset-btn').forEach(btn => {
                const type = btn.dataset.type;
                const val = parseFloat(btn.dataset.value);

                let isActive = false;
                if (type === 'gravity' && Math.abs(g - val) < 0.001) isActive = true;
                if (type === 'drag' && Math.abs(cd - val) < 0.001) isActive = true;

                if (isActive) btn.classList.add('active');
                else btn.classList.remove('active');
            });
        }

        function updateParams() {
            v0 = document.getElementById('v0Slider').value;
            angleDeg = document.getElementById('angleSlider').value;
            h0 = document.getElementById('h0Slider').value;
            g = parseFloat(document.getElementById('gInput').value) || 0;
            mass = document.getElementById('massSlider').value;
            cd = parseFloat(document.getElementById('cdInput').value) || 0;
            ppm = document.getElementById('zoomSlider').value;
            simSpeed = document.getElementById('speedSlider').value;

            isNightMode = document.getElementById('nightModeToggle').checked;

            updateUI();
            render(); // Re-render to show visual updates immediately
        }

        ['v0Slider', 'angleSlider', 'h0Slider', 'massSlider', 'zoomSlider', 'speedSlider'].forEach(id => {
            document.getElementById(id).addEventListener('input', updateParams);
        });

        ['gInput', 'cdInput'].forEach(id => {
            document.getElementById(id).addEventListener('input', updateParams);
            document.getElementById(id).addEventListener('focus', () => {
                // Clear active states of relevant presets when user interacts with input
                const type = id === 'gInput' ? 'gravity' : 'drag';
                document.querySelectorAll(`.preset-btn[data-type="${type}"]`).forEach(btn => btn.classList.remove('active'));
            });
        });

        document.getElementById('nightModeToggle').addEventListener('change', updateParams);

        document.getElementById('fireBtn').addEventListener('click', () => {
            const p = new Projectile(
                parseFloat(v0),
                parseFloat(angleDeg),
                parseFloat(h0),
                parseFloat(g),
                parseFloat(mass),
                parseFloat(cd)
            );
            projectiles.push(p);
            isSimulating = true;
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            projectiles = [];
            isSimulating = false;
            render();

            document.getElementById('timeDisplay').textContent = "0.00";
            document.getElementById('distDisplay').textContent = "0.00";
            document.getElementById('heightDisplay').textContent = "0.00";
        });

        // Full Browser Logic
        document.getElementById('fullBrowserBtn').addEventListener('click', function () {
            document.body.classList.toggle('full-browser');
            const icon = this.querySelector('i');
            const text = this.lastChild;

            if (document.body.classList.contains('full-browser')) {
                icon.className = 'fas fa-compress';
                text.textContent = ' Exit Full';
            } else {
                icon.className = 'fas fa-expand';
                text.textContent = ' Full Browser';
            }

            setTimeout(setupCanvas, 50); // Small delay to allow layout change
        });

        // Preset Buttons Logic
        document.querySelectorAll('.preset-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const type = btn.dataset.type;
                const val = parseFloat(btn.dataset.value);

                if (type === 'gravity') {
                    g = val;
                    document.getElementById('gInput').value = g;
                } else if (type === 'drag') {
                    cd = val;
                    document.getElementById('cdInput').value = cd;
                }

                updateParams();
            });
        });

    </script>
</body>

</html>